<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Nova</title>
<style>
body {
  margin:0;
  font-family:sans-serif;
  background:#0b1220;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.card {
  background:#1b2435;
  padding:30px;
  border-radius:16px;
  text-align:center;
  width:260px;
}

button {
  background:#4285f4;
  border:none;
  color:white;
  padding:10px;
  border-radius:8px;
  cursor:pointer;
  width:100%;
  font-size:14px;
}

.hidden { display:none; }
img { border-radius:50%; width:80px; margin-bottom:10px; }
</style>
</head>

<body>

<!-- ログイン画面 -->
<div id="login" class="card">
  <h2>Nova</h2>
  <p>ログインしてください</p>
  <button onclick="login()">Googleでログイン</button>
</div>

<!-- ホーム画面 -->
<div id="home" class="card hidden">
  <h2>ホーム</h2>
  <p id="welcome"></p>
  <button onclick="openProfile()">プロフィール</button>
  <br><br>
  <button onclick="logout()">ログアウト</button>
</div>

<!-- プロフィール画面 -->
<div id="profile" class="card hidden">
  <img id="avatar">
  <h3 id="name"></h3>
  <p id="email"></p>
  <button onclick="goHome()">戻る</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyDllB-KfT1aAT8nWlcWAKsQCV6o6xpqwzA",
  authDomain: "nova-a7c84.firebaseapp.com",
  projectId: "nova-a7c84",
  storageBucket: "nova-a7c84.firebasestorage.app",
  messagingSenderId: "801132117991",
  appId: "1:801132117991:web:f56f4b4497703b65dd0742"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const provider = new GoogleAuthProvider();

window.login = () => signInWithPopup(auth, provider);
window.logout = () => signOut(auth);

window.openProfile = () => {
  show("profile");
};

window.goHome = () => {
  show("home");
};

function show(page){
  document.getElementById("login").classList.add("hidden");
  document.getElementById("home").classList.add("hidden");
  document.getElementById("profile").classList.add("hidden");
  document.getElementById(page).classList.remove("hidden");
}

onAuthStateChanged(auth, user => {
  if(user){
    document.getElementById("welcome").innerText = "ようこそ " + user.displayName;
    document.getElementById("name").innerText = user.displayName;
    document.getElementById("email").innerText = user.email;
    document.getElementById("avatar").src = user.photoURL;
    show("home");
  } else {
    show("login");
  }
});
</script>

</body>
</html>
